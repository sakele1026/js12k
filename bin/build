#!/bin/bash

set -e

mkdir -p dist
postcss styles.css > dist/styles.css
html-minifier \
  --collapse-whitespace \
  --remove-comments \
  --remove-attribute-quotes \
  --remove-optional-tags \
  --remove-tag-whitespace \
  index.html > dist/index.html
cp TinyMusic.min.js dist/TinyMusic.min.js
rollup -f es index.js | uglifyjs -cm --toplevel > dist/index.js
cat TinyMusic.min.js | uglifyjs -cm > dist/TinyMusic.min.js
zip dist/onoff.zip dist/index.html dist/index.js dist/styles.css
